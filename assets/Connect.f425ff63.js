import{C as ee,L as le}from"./ListContainer.37c72602.js";import{_ as P,d as A,c as p,a2 as V,o as e,g as a,q as r,w as f,a0 as k,$ as B,n as oe,u as s,X as ie,a3 as de,a as b,a4 as R,I as te,x as _,t as E,Q as ce,r as $,p as q,k as T,a5 as re,y as ue,z as ve,T as F,a6 as G,a1 as me,U as ge,V as fe,b as x,h as O,a7 as ae,a8 as pe,a9 as ne,aa as W,ab as Q,ac as _e,v as L,B as ye,ad as he,G as be,ae as X,af as Y,ag as xe,ah as ke,ai as we,O as D,aj as Ie,ak as M,M as H,al as J,am as j,an as Ce,ao as $e}from"./index.4f644f62.js";import{P as Se}from"./ProfilePreview.77ab884b.js";const Ve={class:"wallet-tabs"},Te=["onClick"],Pe=A({props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:i}){const d=t,o=p({get(){return d.modelValue},set(u){i("update:modelValue",u)}}),n=p(()=>V.value.findIndex(u=>u.id===o.value));return(u,c)=>(e(),a("div",Ve,[r(ee,{modelValue:s(n),"onUpdate:modelValue":c[0]||(c[0]=l=>de(n)?n.value=l:null),options:{align:"center",overscroll:!0,immediate:!0}},{default:f(()=>[(e(!0),a(k,null,B(s(V),l=>(e(),a("button",{key:l.id,type:"button",onClick:g=>o.value=l.id,class:oe(["tab",{active:l.id==s(o)}])},[r(ie,{address:l.key},null,8,["address"])],10,Te))),128))]),_:1},8,["modelValue"])]))}});var je=P(Pe,[["__scopeId","data-v-35e1b97b"]]);const Ee={class:"icon-background"},Ae={props:["icon","img"],setup(t){return(i,d)=>(e(),a("div",Ee,[t.img?(e(),b(R,{key:0,class:"page-logo",icon:t.img},null,8,["icon"])):(e(),b(R,{key:1,class:"page-logo placeholder",icon:t.icon},null,8,["icon"]))]))}};var Be=P(Ae,[["__scopeId","data-v-7f69d89a"]]);const Oe={class:"tx-card-extension"},Ne={key:0,class:"flex-row",style:{"justify-content":"space-between"}},ze={key:0},Ue={key:1},Le={key:1,class:"tags secondary-text no-scrollbar"},Me={props:["tx"],setup(t){return p(()=>te.breakpoints.verticalLayout),(i,d)=>(e(),a("div",Oe,[t.tx.tags.length||t.tx.data_size?(e(),a("div",Ne,[t.tx.tags.length?(e(),a("div",ze,"Tags:")):_("",!0),t.tx.data_size?(e(),a("div",Ue,"Data: "+E(s(ce)(t.tx.data_size)),1)):_("",!0)])):_("",!0),t.tx.tags.length?(e(),a("ul",Le,[(e(!0),a(k,null,B(t.tx.tags,o=>(e(),a("li",null,E(o.name+" | "+o.value),1))),256))])):_("",!0)]))}};var Z=P(Me,[["__scopeId","data-v-5ee7fb30"]]);const se=t=>(ge("data-v-cde7db32"),t=t(),fe(),t),Re={class:"permission-card"},We=se(()=>x("span",null,"Sign transaction",-1)),De=se(()=>x("span",null,"Sign transaction and upload",-1)),Ke=O(" Share the public key "),qe=O(" Share the arweave config "),Fe=O(" Sign data "),Ge=O(" Decrypt data "),Qe=A({props:{messageEntry:null},setup(t){const i=t,d=$(null),o=p(()=>{if(d.value?.method!=="signTransaction"&&d.value?.method!=="dispatch")return;const c=d.value?.params?.[0],l=c.tags?.map(({name:g,value:w})=>({name:q.utils.b64UrlToString(g),value:q.utils.b64UrlToString(w)}));return{...c,tags:l}});T(()=>i.messageEntry,async()=>{d.value=await re(i.messageEntry)},{immediate:!0});const n=[{name:"Accept",icon:ae,run:()=>i.messageEntry.status="accepted"},{name:"Reject",icon:pe,run:()=>i.messageEntry.status="rejected"}],u=[{name:"Pending",icon:ne,run:()=>{}}];return(c,l)=>ue((e(),a("div",Re,[d.value?.method==="signTransaction"?(e(),a(k,{key:0},[We,r(F,{tx:s(o)},null,8,["tx"]),r(Z,{tx:s(o)},null,8,["tx"])],64)):_("",!0),d.value?.method==="dispatch"?(e(),a(k,{key:1},[De,r(F,{tx:s(o)},null,8,["tx"]),r(Z,{tx:s(o)},null,8,["tx"])],64)):d.value?.method==="getPublicKey"?(e(),a(k,{key:2},[Ke],64)):d.value?.method==="getArweaveConfig"?(e(),a(k,{key:3},[qe],64)):d.value?.method==="sign"?(e(),a(k,{key:4},[Fe],64)):d.value?.method==="decrypt"?(e(),a(k,{key:5},[Ge],64)):_("",!0),r(me,{name:"fade",mode:"out-in"},{default:f(()=>[t.messageEntry.status?(e(),b(G,{key:1,actions:u})):(e(),b(G,{key:0,actions:n}))]),_:1})],512)),[[ve,d.value]])}});var Xe=P(Qe,[["__scopeId","data-v-cde7db32"]]);const Ye={class:"flex-column no-scrollbar"},He=["disabled","onClick"],Je=O(" Apply "),Ze=A({props:{state:null,walletId:null},setup(t){const i=t,d={connect:"Connect automatically",signTransaction:"Sign transaction",getPublicKey:"Share public key",sign:"Sign arbitrary data",decrypt:"Decrypt data",getArweaveConfig:"Share arweave gateway configuration"},o=v=>["connect"].concat(Object.getOwnPropertyNames(Object.getPrototypeOf(v?.messageRunner||{}))).filter(m=>{if(!(m==="constructor"||m==="methodMap"||!v))return!Q(v,m)?.unavailable}).map(m=>({name:m,displayName:d[m]||m,disabled:Q(v,m)?.userIntent})),n=p(()=>W(i.walletId)),u=p(()=>[...o(n.value)]),c=v=>g.value&&(g.value[v]=!g.value[v]),l=_e("connectionSettings:",i.state.origin,{}),g=$(void 0),w=$(void 0);T(n,v=>{!v?.uuid||(l.state.value||={},w.value=l.state.value[v.uuid]||={},g.value={...w.value})},{immediate:!0});const S=([v,m])=>{const y=w.value?.[v]||!1;if(m!==y)return!0},N=p(()=>g.value?Object.entries(g.value).find(S):!1),z=()=>{if(!g.value||!w.value)return!1;Object.entries(g.value).filter(S).forEach(([v,m])=>w.value&&(w.value[v]=m))};return(v,m)=>(e(),a("div",Ye,[(e(!0),a(k,null,B(s(u),y=>(e(),a("button",{key:y.name,disabled:y.disabled,class:"row method",onClick:U=>c(y.name)},[x("div",null,E(y.displayName),1),r(L,{vector:g.value[y.name]?1:-1,axis:"y"},{default:f(()=>[(e(),a("div",{key:g.value[y.name]},E(g.value[y.name]?"Allow":"Ask"),1))]),_:2},1032,["vector"])],8,He))),128)),r(L,null,{default:f(()=>[s(N)?(e(),b(ye,{key:0,onClick:m[0]||(m[0]=y=>z())},{default:f(()=>[Je]),_:1})):_("",!0)]),_:1})]))}});var et=P(Ze,[["__scopeId","data-v-239033a2"]]);const tt={class:"flex-row"},at=["disabled"],nt={style:{"min-width":"0"}},st={class:"ellipsis"},lt={class:"secondary-text ellipsis"},ot={class:"page-container",key:"0"},it={key:0},dt={class:"status fade-list-item",key:"1"},ct={key:1},rt=A({props:{state:null},setup(t){const i=t,d=he(),o=V.value[0]?.id;p(()=>V.value.map(h=>h.key));const n=$(i.state.walletId||o),u=p(()=>W(n.value));p(()=>W(o));const c=[{name:"Requests",color:"var(--orange)"},{name:"Permissions",color:"var(--green)"}],l=$(n.value?c[0].name:null);T(()=>i.state.walletId,h=>{!h||(S.value=!1,n.value=h,l.value=c[0].name)});const g=()=>i.state.walletId=!1,w=()=>{S.value=!1,i.state.walletId=n.value+""},S=$(!i.state.walletId),N=p(()=>S.value&&V.value.length>1),z=$(0),v=()=>{if(!S.value){S.value=!0;return}n.value!==(i.state.walletId||V.value[0]?.id)&&z.value++,n.value=i.state.walletId||V.value[0]?.id,S.value=!1},m=p(()=>({actions:[{name:i.state.walletId?"Switch":"Connect",icon:ae,run:w}]})),y=p(()=>n.value!==i.state.walletId?[]:i.state.messageQueue?.filter(h=>!h.fulfilled));be(te.breakpoints,"verticalLayout");const U=$(null),K=(h,I)=>U.value=h-I;return T(()=>c.findIndex(h=>h.name===l.value),K),T(()=>V.value.findIndex(h=>h.id===n.value),K),(h,I)=>(e(),b(le,{class:"connection-card flex-column no-scrollbar"},{header:f(()=>[x("div",tt,[x("button",{type:"button",class:"info flex-row",onClick:I[0]||(I[0]=(...C)=>s(X)&&s(X)(...C)),disabled:!s(Y)(t.state.origin,t.state.session)},[r(Be,{img:t.state.appInfo?.logo,icon:s(ne)},null,8,["img","icon"]),x("div",nt,[x("div",st,E(t.state.appInfo?.name||"Connector"),1),x("div",lt,E(t.state.origin),1)]),s(Y)(t.state.origin,t.state.session)?(e(),b(R,{key:0,icon:s(xe)},null,8,["icon"])):_("",!0)],8,at),r(ke,{modelValue:t.state.walletId,"onUpdate:modelValue":I[1]||(I[1]=C=>t.state.walletId=C),active:!s(N),onSelectWallet:v,onExit:g},null,8,["modelValue","active"])]),r(we,{tabs:c,modelValue:l.value,"onUpdate:modelValue":I[2]||(I[2]=C=>l.value=C),disabled:!n.value},null,8,["modelValue","disabled"])]),default:f(()=>[r(L,{vector:U.value,axis:"x"},{default:f(()=>[s(V).length?(e(),a("div",{class:"container-scroll",key:z.value},[r(M,{name:"fade-list"},{default:f(()=>[s(N)?(e(),b(je,{modelValue:n.value,"onUpdate:modelValue":I[3]||(I[3]=C=>n.value=C),class:"fade-list-item",key:"-1"},null,8,["modelValue"])):_("",!0),x("div",ot,[r(L,{vector:U.value,axis:"x"},{default:f(()=>[(e(),a("div",{key:(n.value||"")+l.value,class:"content"},[l.value==="Requests"?(e(),a("div",it,[r(M,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:H({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),s(y)?.length===0&&t.state.walletId&&t.state.walletId===n.value?(e(),a("div",dt,"Connected")):_("",!0),n.value!==t.state.walletId?(e(),b(D,{options:s(m),inline:!0,class:"fade-list-item",key:"2"},{default:f(()=>[s(u)?(e(),b(Se,{key:0,wallet:s(u)},null,8,["wallet"])):_("",!0)]),_:1},8,["options"])):_("",!0),(e(!0),a(k,null,B(s(y),C=>(e(),b(Xe,{key:C.uuid,messageEntry:C,style:{padding:"var(--spacing)"},class:"flex-column fade-list-item"},null,8,["messageEntry"]))),128))]),_:1})])):l.value==="Permissions"?(e(),a("div",ct,[r(M,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:H({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),r(et,{state:t.state,walletId:n.value,class:"fade-list-item",key:"2"},null,8,["state","walletId"])]),_:1})])):_("",!0)]))]),_:1},8,["vector"])])]),_:1})])):(e(),b(D,{key:0,options:{action:{icon:s(Ie),name:"Add wallet",run:()=>s(d).push("/add")}}},null,8,["options"]))]),_:1},8,["vector"])]),_:1}))}});var ut=P(rt,[["__scopeId","data-v-d7a3ed62"]]);const vt={class:"connect flex-column"},mt={key:0,class:"connection-card-container fade-list-item",style:{position:"relative"}},gt=A({setup(t){const i=p(()=>({action:{icon:Ce,name:"Connect to "+n.value,run:()=>J("connect")}}));let d=!0;setTimeout(()=>d=!1,500);const o=$(-1);T(j,()=>{const u=j.value.findIndex(c=>c.origin===$e.value.origin);!d||u<0||o.value>=0||(o.value=u,d=!1)},{immediate:!0});const n=$();return J("state").then(u=>{!u||(n.value=u.origin,T(()=>j.value,()=>{const c=j.value.findIndex(l=>l.origin===n.value);if(c<0&&o.value>=0)return o.value=c;if(o.value<0)return setTimeout(()=>o.value=c)},{immediate:!0}))}),(u,c)=>(e(),a("div",vt,[r(ee,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=l=>o.value=l),options:{align:"start",overscroll:!0},class:"connectors"},{default:f(()=>[!s(j).length&&n.value?(e(),a("div",mt,[r(D,{options:s(i)},null,8,["options"])])):_("",!0),(e(!0),a(k,null,B(s(j),l=>(e(),a("div",{key:l.origin+l.session,class:"connection-card-container fade-list-item"},[r(ut,{state:l,class:"box"},null,8,["state"])]))),128))]),_:1},8,["modelValue"])]))}});var yt=P(gt,[["__scopeId","data-v-51c8a3de"]]);export{yt as default};
//# sourceMappingURL=Connect.f425ff63.js.map
