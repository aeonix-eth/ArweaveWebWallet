import{C as J,L as se}from"./ListContainer.2a67451b.js";import{_ as T,d as A,c as p,a2 as V,o as e,g as a,q as r,w as f,Z as w,$ as B,n as le,u as s,V as oe,a3 as ie,a as b,X as W,I as ee,x as _,t as E,O as de,r as $,k as P,a4 as ce,y as re,z as ue,T as F,a5 as q,a1 as ve,R as me,S as ge,b as x,h as O,a6 as te,a7 as fe,a8 as ae,a9 as D,aa as X,ab as pe,v as L,B as _e,ac as ye,F as he,ad as G,ae as Q,af as be,ag as xe,ah as we,ai as ke,aj as M,K as Y,ak as Z,al as j,am as Ie,an as Ce}from"./index.84c38c32.js";import{P as $e}from"./ProfilePreview.7f76093c.js";import{O as K}from"./OverlayPrompt.a6e8b37e.js";const Se={class:"wallet-tabs"},Ve=["onClick"],Pe=A({props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:i}){const d=t,o=p({get(){return d.modelValue},set(u){i("update:modelValue",u)}}),n=p(()=>V.value.findIndex(u=>u.id===o.value));return(u,c)=>(e(),a("div",Se,[r(J,{modelValue:s(n),"onUpdate:modelValue":c[0]||(c[0]=l=>ie(n)?n.value=l:null),options:{align:"center",overscroll:!0,immediate:!0}},{default:f(()=>[(e(!0),a(w,null,B(s(V),l=>(e(),a("button",{key:l.id,type:"button",onClick:g=>o.value=l.id,class:le(["tab",{active:l.id==s(o)}])},[r(oe,{address:l.key},null,8,["address"])],10,Ve))),128))]),_:1},8,["modelValue"])]))}});var Te=T(Pe,[["__scopeId","data-v-35e1b97b"]]);const je={class:"icon-background"},Ee={props:["icon","img"],setup(t){return(i,d)=>(e(),a("div",je,[t.img?(e(),b(W,{key:0,class:"page-logo",icon:t.img},null,8,["icon"])):(e(),b(W,{key:1,class:"page-logo placeholder",icon:t.icon},null,8,["icon"]))]))}};var Ae=T(Ee,[["__scopeId","data-v-7f69d89a"]]);const Be={class:"tx-card-extension"},Oe={key:0,class:"flex-row",style:{"justify-content":"space-between"}},Ne={key:0},ze={key:1},Re={key:1,class:"tags secondary-text no-scrollbar"},Le={props:["tx"],setup(t){return p(()=>ee.breakpoints.verticalLayout),(i,d)=>(e(),a("div",Be,[t.tx.tags.length||t.tx.data_size?(e(),a("div",Oe,[t.tx.tags.length?(e(),a("div",Ne,"Tags:")):_("",!0),t.tx.data_size?(e(),a("div",ze,"Data: "+E(s(de)(t.tx.data_size)),1)):_("",!0)])):_("",!0),t.tx.tags.length?(e(),a("ul",Re,[(e(!0),a(w,null,B(t.tx.tags,o=>(e(),a("li",null,E(o.name+" | "+o.value),1))),256))])):_("",!0)]))}};var H=T(Le,[["__scopeId","data-v-5ee7fb30"]]);const ne=t=>(me("data-v-558bc70a"),t=t(),ge(),t),Me={class:"permission-card"},We=ne(()=>x("span",null,"Sign transaction",-1)),De=ne(()=>x("span",null,"Sign transaction and upload",-1)),Ke=O(" Share the public key "),Ue=O(" Share the arweave config "),Fe=O(" Sign data "),qe=O(" Decrypt data "),Xe=A({props:{messageEntry:null},setup(t){const i=t,d=$(null),o=p(()=>{if(d.value?.method!=="signTransaction"&&d.value?.method!=="dispatch")return;const c=d.value?.params?.[0],l=c.tags?.map(({name:g,value:k})=>({name:window.atob(g),value:window.atob(k)}));return{...c,tags:l}});P(()=>i.messageEntry,async()=>{d.value=await ce(i.messageEntry)},{immediate:!0});const n=[{name:"Accept",icon:te,run:()=>i.messageEntry.status="accepted"},{name:"Reject",icon:fe,run:()=>i.messageEntry.status="rejected"}],u=[{name:"Pending",icon:ae,run:()=>{}}];return(c,l)=>re((e(),a("div",Me,[d.value?.method==="signTransaction"?(e(),a(w,{key:0},[We,r(F,{tx:s(o)},null,8,["tx"]),r(H,{tx:s(o)},null,8,["tx"])],64)):_("",!0),d.value?.method==="dispatch"?(e(),a(w,{key:1},[De,r(F,{tx:s(o)},null,8,["tx"]),r(H,{tx:s(o)},null,8,["tx"])],64)):d.value?.method==="getPublicKey"?(e(),a(w,{key:2},[Ke],64)):d.value?.method==="getArweaveConfig"?(e(),a(w,{key:3},[Ue],64)):d.value?.method==="sign"?(e(),a(w,{key:4},[Fe],64)):d.value?.method==="decrypt"?(e(),a(w,{key:5},[qe],64)):_("",!0),r(ve,{name:"fade",mode:"out-in"},{default:f(()=>[t.messageEntry.status?(e(),b(q,{key:1,actions:u})):(e(),b(q,{key:0,actions:n}))]),_:1})],512)),[[ue,d.value]])}});var Ge=T(Xe,[["__scopeId","data-v-558bc70a"]]);const Qe={class:"flex-column no-scrollbar"},Ye=["disabled","onClick"],Ze=O(" Apply "),He=A({props:{state:null,walletId:null},setup(t){const i=t,d={connect:"Connect automatically",signTransaction:"Sign transaction",getPublicKey:"Share public key",sign:"Sign arbitrary data",decrypt:"Decrypt data",getArweaveConfig:"Share arweave gateway configuration"},o=v=>Object.getOwnPropertyNames(Object.getPrototypeOf(v?.messageRunner||{})).filter(m=>{if(!(m==="constructor"||m==="methodMap"||!v))return!X(v,m)?.unavailable}).map(m=>({name:m,displayName:d[m]||m,disabled:X(v,m)?.userIntent})),n=p(()=>D(i.walletId)),u=p(()=>[...o(n.value)]),c=v=>g.value&&(g.value[v]=!g.value[v]),l=pe("connectionSettings:",i.state.origin,{}),g=$(void 0),k=$(void 0);P(n,v=>{!v?.uuid||(l.state.value||={},k.value=l.state.value[v.uuid]||={},g.value={...k.value})},{immediate:!0});const S=([v,m])=>{const y=k.value?.[v]||!1;if(m!==y)return!0},N=p(()=>g.value?Object.entries(g.value).find(S):!1),z=()=>{if(!g.value||!k.value)return!1;Object.entries(g.value).filter(S).forEach(([v,m])=>k.value&&(k.value[v]=m))};return(v,m)=>(e(),a("div",Qe,[(e(!0),a(w,null,B(s(u),y=>(e(),a("button",{key:y.name,disabled:y.disabled,class:"row method",onClick:R=>c(y.name)},[x("div",null,E(y.displayName),1),r(L,{vector:g.value[y.name]?1:-1,axis:"y"},{default:f(()=>[(e(),a("div",{key:g.value[y.name]},E(g.value[y.name]?"Allow":"Ask"),1))]),_:2},1032,["vector"])],8,Ye))),128)),r(L,null,{default:f(()=>[s(N)?(e(),b(_e,{key:0,onClick:m[0]||(m[0]=y=>z())},{default:f(()=>[Ze]),_:1})):_("",!0)]),_:1})]))}});var Je=T(He,[["__scopeId","data-v-9386663e"]]);const et={class:"flex-row"},tt=["disabled"],at={style:{"min-width":"0"}},nt={class:"ellipsis"},st={class:"secondary-text ellipsis"},lt={class:"page-container",key:"0"},ot={key:0},it={class:"status fade-list-item",key:"1"},dt={key:1},ct=A({props:{state:null},setup(t){const i=t,d=ye(),o=V.value[0]?.id;p(()=>V.value.map(h=>h.key));const n=$(i.state.walletId||o),u=p(()=>D(n.value));p(()=>D(o));const c=[{name:"Requests",color:"var(--orange)"},{name:"Permissions",color:"var(--green)"}],l=$(n.value?c[0].name:null);P(()=>i.state.walletId,h=>{!h||(S.value=!1,n.value=h,l.value=c[0].name)});const g=()=>i.state.walletId=!1,k=()=>{S.value=!1,i.state.walletId=n.value+""},S=$(!i.state.walletId),N=p(()=>S.value&&V.value.length>1),z=$(0),v=()=>{if(!S.value){S.value=!0;return}n.value!==(i.state.walletId||V.value[0]?.id)&&z.value++,n.value=i.state.walletId||V.value[0]?.id,S.value=!1},m=p(()=>({actions:[{name:i.state.walletId?"Switch":"Connect",icon:te,run:k}]})),y=p(()=>n.value!==i.state.walletId?[]:i.state.messageQueue?.filter(h=>!h.fulfilled));he(ee.breakpoints,"verticalLayout");const R=$(null),U=(h,I)=>R.value=h-I;return P(()=>c.findIndex(h=>h.name===l.value),U),P(()=>V.value.findIndex(h=>h.id===n.value),U),(h,I)=>(e(),b(se,{class:"connection-card flex-column no-scrollbar"},{header:f(()=>[x("div",et,[x("button",{type:"button",class:"info flex-row",onClick:I[0]||(I[0]=(...C)=>s(G)&&s(G)(...C)),disabled:!s(Q)(t.state.origin,t.state.session)},[r(Ae,{img:t.state.appInfo?.logo,icon:s(ae)},null,8,["img","icon"]),x("div",at,[x("div",nt,E(t.state.appInfo?.name||"Connector"),1),x("div",st,E(t.state.origin),1)]),s(Q)(t.state.origin,t.state.session)?(e(),b(W,{key:0,icon:s(be)},null,8,["icon"])):_("",!0)],8,tt),r(xe,{modelValue:t.state.walletId,"onUpdate:modelValue":I[1]||(I[1]=C=>t.state.walletId=C),active:!s(N),onSelectWallet:v,onExit:g},null,8,["modelValue","active"])]),r(we,{tabs:c,modelValue:l.value,"onUpdate:modelValue":I[2]||(I[2]=C=>l.value=C),disabled:!n.value},null,8,["modelValue","disabled"])]),default:f(()=>[r(L,{vector:R.value,axis:"x"},{default:f(()=>[s(V).length?(e(),a("div",{class:"container-scroll",key:z.value},[r(M,{name:"fade-list"},{default:f(()=>[s(N)?(e(),b(Te,{modelValue:n.value,"onUpdate:modelValue":I[3]||(I[3]=C=>n.value=C),class:"fade-list-item",key:"-1"},null,8,["modelValue"])):_("",!0),x("div",lt,[r(L,{vector:R.value,axis:"x"},{default:f(()=>[(e(),a("div",{key:(n.value||"")+l.value,class:"content"},[l.value==="Requests"?(e(),a("div",ot,[r(M,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:Y({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),s(y)?.length===0&&t.state.walletId&&t.state.walletId===n.value?(e(),a("div",it,"Connected")):_("",!0),n.value!==t.state.walletId?(e(),b(K,{options:s(m),inline:!0,class:"fade-list-item",key:"2"},{default:f(()=>[s(u)?(e(),b($e,{key:0,wallet:s(u)},null,8,["wallet"])):_("",!0)]),_:1},8,["options"])):_("",!0),(e(!0),a(w,null,B(s(y),C=>(e(),b(Ge,{key:C.uuid,messageEntry:C,style:{padding:"var(--spacing)"},class:"flex-column fade-list-item"},null,8,["messageEntry"]))),128))]),_:1})])):l.value==="Permissions"?(e(),a("div",dt,[r(M,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:Y({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),r(Je,{state:t.state,walletId:n.value,class:"fade-list-item",key:"2"},null,8,["state","walletId"])]),_:1})])):_("",!0)]))]),_:1},8,["vector"])])]),_:1})])):(e(),b(K,{key:0,options:{action:{icon:s(ke),name:"Add wallet",run:()=>s(d).push("/add")}}},null,8,["options"]))]),_:1},8,["vector"])]),_:1}))}});var rt=T(ct,[["__scopeId","data-v-d7a3ed62"]]);const ut={class:"connect flex-column"},vt={key:0,class:"connection-card-container fade-list-item",style:{position:"relative"}},mt=A({setup(t){const i=p(()=>({action:{icon:Ie,name:"Connect to "+n.value,run:()=>Z("connect")}}));let d=!0;setTimeout(()=>d=!1,500);const o=$(-1);P(j,()=>{const u=j.value.findIndex(c=>c.origin===Ce.value.origin);!d||u<0||o.value>=0||(o.value=u,d=!1)},{immediate:!0});const n=$();return Z("state").then(u=>{!u||(n.value=u.origin,P(()=>j.value,()=>{const c=j.value.findIndex(l=>l.origin===n.value);if(c<0&&o.value>=0)return o.value=c;if(o.value<0)return setTimeout(()=>o.value=c)},{immediate:!0}))}),(u,c)=>(e(),a("div",ut,[r(J,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=l=>o.value=l),options:{align:"start",overscroll:!0},class:"connectors"},{default:f(()=>[!s(j).length&&n.value?(e(),a("div",vt,[r(K,{options:s(i)},null,8,["options"])])):_("",!0),(e(!0),a(w,null,B(s(j),l=>(e(),a("div",{key:l.origin+l.session,class:"connection-card-container fade-list-item"},[r(rt,{state:l,class:"box"},null,8,["state"])]))),128))]),_:1},8,["modelValue"])]))}});var yt=T(mt,[["__scopeId","data-v-51c8a3de"]]);export{yt as default};
//# sourceMappingURL=Connect.49be903d.js.map
