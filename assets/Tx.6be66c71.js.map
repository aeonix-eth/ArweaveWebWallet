{"version":3,"file":"Tx.6be66c71.js","sources":["../../src/components/handlers/Img.vue","../../src/components/handlers/Selector.vue","../../src/views/Tx.vue"],"sourcesContent":["<template>\n\t<Observer observe=\"resize\" @resize=\"resize\" class=\"img\" :class=\"{ x, y }\">\n\t\t<div class=\"frame-scroller\">\n\t\t\t<img ref=\"imgRef\" :src=\"src\" @load=\"load\" />\n\t\t</div>\n\t</Observer>\n</template>\n\n\n\n<script setup lang=\"ts\">\nimport Observer from '@/components/function/Observer.vue'\nimport { ref, computed } from 'vue'\n\nconst props = defineProps(['src'])\nconst emit = defineEmits(['load'])\n\nconst imgRef = ref(null as null | HTMLImageElement)\nconst elAspect = ref(null as null | number)\nconst imgAspect = ref(null as null | number)\n\nconst resize = (size: ResizeObserverEntry) => {\n\tconsole.log(size)\n\telAspect.value = size.contentRect.width / size.contentRect.height\n}\n\nconst load = () => {\n\timgAspect.value = imgRef.value && imgRef.value.naturalWidth / imgRef.value.naturalHeight\n\temit('load')\n}\n\nconst x = computed(() => elAspect.value && imgAspect.value && elAspect.value < imgAspect.value)\nconst y = computed(() => elAspect.value && imgAspect.value && elAspect.value >= imgAspect.value)\n\n// Todo snap to center\n</script>\n\n\n\n<style scoped>\n.img {\n\twidth: 100%;\n\tmin-width: 0;\n\tflex: 1 1 0;\n\theight: var(--current-vh);\n}\n\n.verticalContent .img {\n\theight: auto;\n\twidth: 100%;\n}\n\n.verticalContent img {\n\theight: auto;\n\twidth: 100%;\n}\n\nimg {\n\tflex: 1 1 0;\n\tdisplay: block;\n\tobject-fit: cover;\n}\n\n.frame-scroller {\n\tdisplay: flex;\n\twidth: 100%;\n\theight: 100%;\n}\n\n.img.x .frame-scroller {\n\toverflow-x: auto;\n\tflex-direction: row;\n}\n\n.img.x img {\n\theight: 100%;\n}\n\n.img.y .frame-scroller {\n\toverflow-y: auto;\n\tflex-direction: column;\n}\n\n.img.y img {\n\twidth: 100%;\n}\n</style>","<template>\n\t<div v-if=\"data.handler === 'intent'\" @click=\"data.intent = true\" class=\"selector data-container box\" style=\"display: flex; justify-content: center; padding-top: 5em;\">\n\t\t<Button :icon=\"IconDownload\">Load large file</Button>\n\t</div>\n\t<div v-else-if=\"data.handler === 'json' || data.handler === 'raw'\" key=\"json\" class=\"selector data-container box\">\n\t\t<pre class=\"raw\">{{ data.payload }}</pre>\n\t</div>\n\t<div v-else-if=\"data.handler\" v-show=\"data.loaded\" v-bind=\"data.handler.containerAttrs\" class=\"selector box\">\n\t\t<component :is=\"data.handler.is\" v-bind=\"data.handler.attrs\" @load=\"data.loaded = true\"></component>\n\t</div>\n</template>\n\n\n\n<script setup lang=\"ts\">\nimport ArweaveStore, { arweave } from '@/store/ArweaveStore'\nimport Img from '@/components/handlers/Img.vue'\nimport Button from '@/components/atomic/Button.vue'\nimport { computed, markRaw, reactive, watch } from 'vue'\nimport { unpackTags } from '@/functions/Transactions'\nimport IconDownload from '@/assets/icons/download.svg?component'\n\ntype Handler = {\n\tis: string | object\n\tattrs?: object\n\tcontainerAttrs?: object\n}\n\nconst props = defineProps(['tx'])\n\nconst data = reactive({\n\thandler: undefined as undefined | Handler | 'intent' | 'raw' | 'json',\n\tpayload: undefined as any,\n\tloaded: false,\n\tintent: false,\n})\n\nconst gatewayLink = computed(() => ArweaveStore.gatewayURL + props.tx.id)\nconst smartweaveLink = computed(() => 'https://arcode.studio/#/' + props.tx.id + '?theme=dark-blue&hideToolbar=true')\n\nconst load = async () => {\n\tif (!props.tx) { return }\n\tif (props.tx.data?.size === '0') { return }\n\tconst tags = unpackTags(props.tx.tags)\n\tif (tags['Bundle-Version']) { return }\n\tif (props.tx.data?.type === 'application/x.arweave-manifest+json' || props.tx.data?.type === 'text/html' || props.tx.data?.type === 'application/pdf') { return data.handler = { is: 'iframe', attrs: { src: gatewayLink.value, class: ['hover'] }, containerAttrs: { class: ['iframe-container'] } } }\n\tif (props.tx.data?.type?.split('/')[0] === 'video') { return data.handler = { is: 'iframe', attrs: { src: gatewayLink.value }, containerAttrs: { class: ['iframe-container'] } } }\n\tif (props.tx.data?.size > 104857600 && !data.intent) { return data.handler = 'intent' }\n\tif (props.tx.data?.type?.split('/')[0] === 'image') { return data.handler = { is: markRaw(Img), attrs: { src: gatewayLink.value }, containerAttrs: { class: ['img-container'] } } }\n\tif (tags['App-Name'] === 'SmartWeaveContract' || tags['App-Name'] === 'SmartWeaveContractSource') { return data.handler = { is: 'iframe', attrs: { src: smartweaveLink.value }, containerAttrs: { class: ['iframe-container'] } } }\n\telse {\n\t\tdata.handler = 'raw'\n\t\ttry {\n\t\t\tdata.payload = (await arweave.api.get(props.tx.id)).data\n\t\t\tif (data.payload[0] === \"{\") {\n\t\t\t\ttry {\n\t\t\t\t\tdata.payload = JSON.stringify(JSON.parse(data.payload), null, 2)\n\t\t\t\t\tdata.handler = 'json'\n\t\t\t\t} catch (e) { }\n\t\t\t}\n\t\t} catch (e) { }\n\t}\n}\n\nwatch(() => props.tx.id, () => {\n\tdata.handler = undefined\n\tdata.payload = undefined\n\tdata.loaded = false\n\tdata.intent = false\n\tload()\n}, { immediate: true })\n\nwatch(() => data.intent, () => {\n\tdata.intent && load()\n})\n</script>\n\n\n\n<style scoped>\n.iframe-container,\n.img-container,\n.data-container {\n\twidth: 100%;\n\tpadding: 0;\n}\n\n.iframe-container,\n.img-container {\n\t/* height: var(--current-vh); */\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.data-container {\n\tmin-height: var(--current-vh);\n\tpadding: var(--spacing);\n}\n\niframe {\n\tflex: 1 1 0;\n\twidth: 100%;\n\theight: 100%;\n\tborder: 0;\n\ttransition: opacity 0.6s ease;\n}\n\niframe.hover {\n\topacity: 0.5;\n}\n\niframe.hover:hover {\n\topacity: 1;\n}\n\n.raw {\n\toverflow: auto;\n\tpadding: var(--spacing);\n\tmargin: 0;\n\twhite-space: pre-wrap;\n}\n</style>","<template>\n\t<div v-if=\"!tx\" style=\"position: relative; width: 100%; min-height: var(--current-vh); color: var(--element-secondary);\">\n\t\t<OverlayPrompt :options=\"{ icon: 'loader' }\" class=\"box\">\n\t\t\t<h2 v-if=\"queryStatus.error\">{{ queryStatus.error }}</h2>\n\t\t\t<h2 v-else>Loading</h2>\n\t\t</OverlayPrompt>\n\t</div>\n\t<FoldingLayout v-else>\n\t\t<template #left>\n\t\t\t<div class=\"meta flex-column\">\n\t\t\t\t<div class=\"box\" style=\"padding: 0;\">\n\t\t\t\t\t<div class=\"box-padding flex-column\" :style=\"[tagsSchema.length && 'padding-bottom: 0']\">\n\t\t\t\t\t\t<TxCard :tx=\"tx\" :options=\"{ half: true }\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<ProfilePreview v-if=\"tx.recipient\" :wallet=\"recipient\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div v-if=\"tx.recipient\" class=\"spacer\" />\n\t\t\t\t\t\t<div v-if=\"tx.recipient\" class=\"divider\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<ProfilePreview :wallet=\"sender\" />\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3>Transaction</h3>\n\t\t\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div v-if=\"isData\"><a :href=\"ArweaveStore.gatewayURL + tx.id\" target=\"_blank\">{{ ArweaveStore.gatewayURLObject?.hostname }}</a></div>\n\t\t\t\t\t\t\t\t\t<div v-if=\"tx.data?.type === 'application/x.arweave-manifest+json'\"><a :href=\"ArweaveStore.gatewayURL + 'tx/' + tx.id + '/data.json'\" target=\"_blank\">Manifest</a></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"secondary-text\"><Address :address=\"tx.id\">ID:&nbsp;</Address></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div v-if=\"tx.bundledIn?.id\">\n\t\t\t\t\t\t\t<h3>Bundle</h3>\n\t\t\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t\t\t<TxCard v-if=\"bundleTx\" :tx=\"bundleTx\" :options=\"{ space: true }\" />\n\t\t\t\t\t\t\t\t<div class=\"secondary-text\"><Address :address=\"tx.bundledIn?.id\">ID:&nbsp;</Address></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div v-if=\"isPending\">\n\t\t\t\t\t\t\t<h3>Pending</h3>\n\t\t\t\t\t\t\t<div v-if=\"status\">Status: {{ status }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t<h3>Block</h3>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\tHeight: {{ tx.block.height }}\n\t\t\t\t\t\t\t\t<span class=\"secondary-text\" v-if=\"networkInfo?.height\">/ {{ networkInfo.height }} ({{ confirmations }} confirmation{{ confirmations > 1 ? 's' : ''}})</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>{{ date }}</div>\n\t\t\t\t\t\t\t<div class=\"spacer\" />\n\t\t\t\t\t\t\t<div class=\"secondary-text\"><Address :address=\"tx.block.id\">ID:&nbsp;</Address></div>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3>Data</h3>\n\t\t\t\t\t\t\t<div>Size: {{ humanFileSize(tx.data.size) }}</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\tFee:\n\t\t\t\t\t\t\t\t<Amount :ar=\"tx.fee.ar\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"tagsSchema.length\">\n\t\t\t\t\t\t\t<h3>Tags</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"tagsSchema.length\" style=\"background: var(--background2); border-radius: var(--border-radius);\">\n\t\t\t\t\t\t<InputGrid :schema=\"tagsSchema\" disabled />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\n\t\t<template #right v-if=\"tx && isData\">\n\t\t\t<Selector :tx=\"tx\" :class=\"{ inline: !verticalContent }\" />\n\t\t</template>\n\t</FoldingLayout>\n</template>\n\n\n\n<script setup lang=\"ts\">\nimport Selector from '@/components/handlers/Selector.vue'\nimport FoldingLayout from '@/components/layout/FoldingLayout.vue'\nimport Address from '@/components/atomic/Address.vue'\nimport AddressIcon from '@/components/atomic/AddressIcon.vue'\nimport InputGrid from '@/components/atomic/InputGrid.vue'\nimport Amount from '@/components/composed/Amount.vue'\nimport ArweaveStore, { arweave, useWatchTx, networkInfo } from '@/store/ArweaveStore'\nimport InterfaceStore from '@/store/InterfaceStore'\nimport { humanFileSize } from '@/functions/Utils'\nimport { watch, computed, ref, toRef } from 'vue'\nimport TxCard from '@/components/composed/TxCard.vue'\nimport WalletInfo from '@/components/composed/WalletInfo.vue'\nimport { getAccountByAddress } from '@/functions/Wallets'\nimport ProfilePreview from '@/components/composed/ProfilePreview.vue'\nimport OverlayPrompt from '@/components/layout/OverlayPrompt.vue'\n\nconst props = defineProps<{\n\ttxId: string\n}>()\n\nconst handler = useWatchTx(toRef(props, 'txId'))\nconst tx = handler.state\nconst queryStatus = handler.queryStatus\n\nconst bundleId = computed(() => tx.value?.bundledIn?.id)\nconst bundleTx = useWatchTx(bundleId).state\n\nconst sender = computed(() => tx.value?.owner && getAccountByAddress(tx.value?.owner.address))\nconst recipient = computed(() => tx.value?.recipient && getAccountByAddress(tx.value?.recipient))\n\nconst isData = computed(() => tx.value?.data?.size != 0)\nconst isPending = computed(() => !tx.value?.block)\nconst date = computed(() => {\n\tif (!tx.value?.block) { return '' }\n\tconst dateObj = new Date(tx.value?.block.timestamp * 1000)\n\treturn dateObj.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' })\n\t\t+ ' ' + dateObj.toLocaleTimeString()\n})\nconst status = ref(null as any)\nconst confirmations = computed(() => networkInfo.value?.height - tx.value?.block?.height + 1)\nconst tagsSchema = computed(() => {\n\tif (!tx.value?.tags) { return }\n\tconst result = []\n\tfor (const tag of tx.value?.tags) {\n\t\tresult.push({\n\t\t\titems: [\n\t\t\t\t{ name: '', value: tag.name, attrs: { disabled: true } },\n\t\t\t\t{ name: '', value: tag.value, attrs: { disabled: true } }\n\t\t\t]\n\t\t})\n\t}\n\treturn result\n})\nwatch(() => props.txId, async () => {\n\tconst id = tx.value?.bundledIn?.id || props.txId\n\tif (!id) { return }\n\tarweave.transactions.getStatus(id).then(s => status.value = s.status).catch(() => status.value = 'Not Found')\n}, { immediate: true })\nconst verticalContent = toRef(InterfaceStore.breakpoints, 'verticalContent')\n</script>\n\n\n\n<style scoped>\n.meta {\n\tmax-width: var(--column-large-width);\n\tpadding: var(--spacing);\n\twhite-space: nowrap;\n}\n\n.box-padding {\n\tpadding: var(--spacing);\n}\n\n.spacer {\n\theight: var(--spacing);\n}\n\n.divider {\n\tborder-bottom: solid 1px var(--border2);\n\tposition: relative;\n}\n\n.divider:after {\n\t--size: 32px;\n\tcontent: \"\";\n\tbackground: var(--background2);\n\theight: var(--size);\n\twidth: var(--size);\n\tborder-top: solid 1px var(--border2);\n\tborder-left: solid 1px var(--border2);\n\tposition: absolute;\n\tright: calc(50% - var(--size) / 2);\n\tbottom: calc(-1px - var(--size) / 2);\n\ttransform: rotate(45deg);\n\tmargin-top: -1rem;\n}\n\n.verticalContent .meta {\n\tmax-width: 100%;\n}\n\n.row {\n\tmin-height: 2em;\n\talign-items: flex-start;\n\tjustify-content: space-between;\n}\n\n.row > .item {\n\tflex: 1 1 0;\n\tmin-width: 0;\n\tmin-height: 200px;\n\toverflow: hidden;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.circle {\n\tflex: 0 0 auto;\n\twidth: 200px;\n\theight: 200px;\n\tfont-size: 1.5em;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 4px solid var(--border);\n\tborder-radius: 50%;\n}\n\n.address {\n\tmax-width: 100%;\n}\n\n.input-grid {\n\tpadding: var(--spacing) 0;\n\tborder-radius: 0;\n\tbackground: var(--background);\n\tborder: 0;\n}\n\n.selector.inline {\n\tmin-height: var(--current-vh);\n}\n\n.verticalContent .selector.iframe-container {\n\tmin-height: 80vh;\n}\n</style>"],"names":[],"mappings":"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"}