{"version":3,"file":"ListContainer.2a67451b.js","sources":["../../src/components/layout/Carousel.vue"],"sourcesContent":["<template>\n\t<div ref=\"root\" class=\"carousel flex-row no-scrollbar\" :style=\"style\">\n\t\t<transition-group name=\"fade-list\">\n\t\t\t<div v-if=\"options?.overscroll\" class=\"margin fade-list-item\" key=\"margin1\">\n\t\t\t\t<Observer class=\"limit start\" @intersection=\"val => emit('start', val)\" />\n\t\t\t</div>\n\t\t\t<slot />\n\t\t\t<div v-if=\"options?.overscroll\" class=\"margin fade-list-item\" key=\"margin2\">\n\t\t\t\t<Observer class=\"limit end\" @intersection=\"val => emit('end', val)\" />\n\t\t\t</div>\n\t\t</transition-group>\n\t</div>\n</template>\n\n\n\n<script setup lang=\"ts\">\nimport Observer from '@/components/function/Observer.vue'\nimport { awaitEffect } from '@/functions/AsyncData'\nimport { onMounted, onBeforeUnmount, ref, computed, watch, nextTick, inject } from 'vue'\n\nconst props = defineProps<{\n\tmodelValue?: number\n\toptions: {\n\t\talign?: ScrollLogicalPosition\n\t\toverscroll: boolean\n\t\timmediate?: boolean\n\t\tawaitTransition?: boolean\n\t}\n}>()\nconst emit = defineEmits(['update:modelValue', 'start', 'end'])\nconst parentTransitionState = inject('transitionState', null as any)\n\nconst model = computed<number | undefined>({\n\tget () { return props.modelValue },\n\tset (value) { emit('update:modelValue', value) }\n})\nconst root = ref(null as null | HTMLElement)\nconst calcOffset = (el: HTMLElement) => {\n\tif (!el || !root.value) { return }\n\tif (props.options.align === 'center') { return el.offsetLeft + el.offsetWidth / 2 - root.value.offsetWidth! / 2 }\n\tif (props.options.align === 'end') { return el.offsetLeft + el.offsetWidth - root.value.offsetWidth! }\n\treturn el.offsetLeft\n}\nconst elements = computed(() => {\n\trefresh.value\n\tif (!root.value?.children) { return [] }\n\treturn Array(...root.value.children).filter(e => !e.classList.contains('margin')) as HTMLElement[]\n})\nconst style = computed(() => ({\n\t'--position': props.options?.align || 'start',\n}))\nconst effect = async (index?: number, instant?: boolean) => {\n\tif (!instant && props.options.awaitTransition) { await awaitEffect(() => !parentTransitionState.running) }\n\tindex = Math.max(index || 0, 0)\n\troot.value?.scroll({\n\t\tleft: calcOffset(elements.value[index]),\n\t\tbehavior: instant ? 'instant' as any : 'smooth',\n\t})\n}\nlet observer: MutationObserver\nconst refresh = ref(0)\nonMounted(async () => {\n\tobserver = new MutationObserver(async () => { refresh.value++ })\n\tobserver.observe(root.value!, { subtree: false, childList: true })\n\tawait nextTick()\n\tawait awaitEffect(() => elements.value.length)\n\tsetTimeout(() => {\n\t\tconst hasInitSlide = !props.options.immediate && model.value && model.value > 0 || false\n\t\tif (!hasInitSlide) { effect(model.value, true) }\n\t\telse { effect(0, true) }\n\t\twatch(model, v => effect(v), { immediate: hasInitSlide })\n\t})\n})\nonBeforeUnmount(() => observer && observer.disconnect())\n</script>\n\n\n\n<style scoped>\n.carousel {\n\t--position: start;\n\twidth: 100%;\n\tscroll-snap-type: x mandatory;\n\toverflow: auto;\n\twhite-space: nowrap;\n\tdisplay: block; /* for transitions */\n\tline-height: 0;\n\toverscroll-behavior-x: contain;\n\tposition: relative;\n}\n\n.carousel > :deep(*) {\n\tline-height: var(--line-height);\n\tvertical-align: bottom;\n}\n\n.carousel > :deep(*:not(.margin)) {\n\tscroll-snap-align: var(--position);\n}\n\n.carousel > :deep(.fade-list-leave-active) {\n\tposition: absolute !important;\n}\n\n.carousel > :deep(.fade-list-rise-leave-active) {\n\tposition: absolute !important;\n}\n\n.margin {\n\twidth: 100%;\n\tdisplay: inline-block;\n\tposition: relative;\n}\n\n.limit {\n\tposition: absolute;\n\tbottom: 0;\n\twidth: 100%;\n\theight: 1px;\n}\n\n.limit.start {\n\tleft: 200px;\n}\n\n.limit.end {\n\tright: 200px;\n}\n</style>"],"names":[],"mappings":"gZA+BM,EAAwB,EAAO,kBAAmB,IAAW,EAE7D,EAAQ,EAA6B,CAC1C,KAAO,CAAE,MAAO,GAAM,UAAW,EACjC,IAAK,EAAO,CAAE,EAAK,oBAAqB,CAAK,CAAE,CAAA,CAC/C,EACK,EAAO,EAAI,IAA0B,EACrC,EAAa,AAAC,GAAoB,CACvC,GAAI,GAAC,GAAM,CAAC,EAAK,OACb,MAAA,GAAM,QAAQ,QAAU,SAAmB,EAAG,WAAa,EAAG,YAAc,EAAI,EAAK,MAAM,YAAe,EAC1G,EAAM,QAAQ,QAAU,MAAgB,EAAG,WAAa,EAAG,YAAc,EAAK,MAAM,YACjF,EAAG,UAAA,EAEL,EAAW,EAAS,IACjB,GAAA,MACJ,AAAC,EAAK,OAAO,SACV,MAAM,GAAG,EAAK,MAAM,QAAQ,EAAE,OAAO,AAAA,GAAK,CAAC,EAAE,UAAU,SAAS,QAAQ,CAAC,EAD5C,GAEpC,EACK,EAAQ,EAAS,IAAO,EAC7B,aAAc,EAAM,SAAS,OAAS,OACrC,EAAA,EACI,EAAS,MAAO,EAAgB,IAAsB,CAC3D,AAAI,CAAC,GAAW,EAAM,QAAQ,iBAAmB,KAAM,GAAY,IAAM,CAAC,EAAsB,OAAO,EACvG,EAAQ,KAAK,IAAI,GAAS,EAAG,CAAC,EAC9B,EAAK,OAAO,OAAO,CAClB,KAAM,EAAW,EAAS,MAAM,EAAM,EACtC,SAAU,EAAU,UAAmB,QAAA,CACvC,CAAA,EAEE,GAAA,GACE,KAAA,GAAU,EAAI,CAAC,EACrB,SAAU,SAAY,CACV,EAAA,GAAI,kBAAiB,SAAY,CAAU,EAAA,OAAA,CAAS,EACtD,EAAA,QAAQ,EAAK,MAAQ,CAAE,QAAS,GAAO,UAAW,GAAM,EACjE,KAAM,GAAS,EACf,KAAM,GAAY,IAAM,EAAS,MAAM,MAAM,EAC7C,WAAW,IAAM,CACV,KAAA,GAAe,CAAC,EAAM,QAAQ,WAAa,EAAM,OAAS,EAAM,MAAQ,GAAK,GACnF,AACO,EADP,AAAK,EACS,EADc,EAAM,MACjB,EAAI,EACf,EAAA,EAAO,GAAK,EAAO,CAAC,EAAG,CAAE,UAAW,EAAc,CAAA,CACxD,CAAA,CACD,EACD,EAAgB,IAAM,GAAY,EAAS,WAAY,CAAA"}