import{C as Z,L as se}from"./ListContainer.79f967bc.js";import{d as A,c as f,o as e,a,g as u,h as g,F as I,f as B,l as le,u as s,i as oe,j as k,W as y,t as T,e as h,r as $,w as E,m as ie,p as ue,T as ce,a3 as re,a4 as de,V as j,aj as ve,U as _e,a5 as D,n as F}from"./vendor.cc129a20.js";import{_ as P,p as V,m as me,o as R,I as ee,i as ge,q as fe,T as q,r as te,s as ye,t as ae,v as M,w as G,x as pe,e as W,B as xe,y as H,z as J,C as he,D as ke,E as Ie,G as O,H as be,J as Q,K as we}from"./index.dfeb5663.js";import{P as Ce}from"./ProfilePreview.43beecc6.js";import{I as $e}from"./launch.943af7ae.js";import{O as U}from"./OverlayPrompt.7efa44c3.js";const Se={class:"wallet-tabs"},Ve=["onClick"],Pe=A({props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:i}){const l=t,o=f({get(){return l.modelValue},set(d){i("update:modelValue",d)}}),n=f(()=>V.value.findIndex(d=>d.id===o.value));return(d,c)=>(e(),a("div",Se,[u(Z,{modelValue:s(n),"onUpdate:modelValue":c[0]||(c[0]=r=>oe(n)?n.value=r:null),options:{align:"center",overscroll:!0,immediate:!0}},{default:g(()=>[(e(!0),a(I,null,B(s(V),r=>(e(),a("button",{key:r.id,type:"button",onClick:m=>o.value=r.id,class:le(["tab",{active:r.id==s(o)}])},[u(me,{address:r.key},null,8,["address"])],10,Ve))),128))]),_:1},8,["modelValue"])]))}});var Te=P(Pe,[["__scopeId","data-v-35e1b97b"]]);const Ee={class:"icon-background"},Ae={props:["icon","img"],setup(t){return(i,l)=>(e(),a("div",Ee,[t.img?(e(),k(R,{key:0,class:"page-logo",icon:t.img},null,8,["icon"])):(e(),k(R,{key:1,class:"page-logo placeholder",icon:t.icon},null,8,["icon"]))]))}};var Be=P(Ae,[["__scopeId","data-v-7f69d89a"]]);const Oe={class:"tx-card-extension"},je={key:0,class:"flex-row",style:{"justify-content":"space-between"}},Ne={key:0},Le={key:1},ze={key:1,class:"tags secondary-text no-scrollbar"},Re={props:["tx"],setup(t){return f(()=>ee.breakpoints.verticalLayout),(i,l)=>(e(),a("div",Oe,[t.tx.tags.length||t.tx.data_size?(e(),a("div",je,[t.tx.tags.length?(e(),a("div",Ne,"Tags:")):y("",!0),t.tx.data_size?(e(),a("div",Le,"Data: "+T(s(ge)(t.tx.data_size)),1)):y("",!0)])):y("",!0),t.tx.tags.length?(e(),a("ul",ze,[(e(!0),a(I,null,B(t.tx.tags,o=>(e(),a("li",null,T(o.name+" | "+o.value),1))),256))])):y("",!0)]))}};var X=P(Re,[["__scopeId","data-v-5ee7fb30"]]);const We={class:"actions-list flex-row"},De=["onClick"],Me=A({props:{actions:null},setup(t){return(i,l)=>(e(),a("div",We,[(e(!0),a(I,null,B(t.actions,o=>(e(),a("button",{key:o.name,onClick:o.run,type:"button",class:"action flex-row"},[u(R,{icon:o.icon},null,8,["icon"]),h("div",null,T(o.name),1)],8,De))),128))]))}});var Y=P(Me,[["__scopeId","data-v-7477f216"]]);const ne=t=>(re("data-v-558bc70a"),t=t(),de(),t),Ue={class:"permission-card"},Ke=ne(()=>h("span",null,"Sign transaction",-1)),Fe=ne(()=>h("span",null,"Sign transaction and upload",-1)),qe=j(" Share the public key "),Ge=j(" Share the arweave config "),He=j(" Sign data "),Je=j(" Decrypt data "),Qe=A({props:{messageEntry:null},setup(t){const i=t,l=$(null),o=f(()=>{if(l.value?.method!=="signTransaction"&&l.value?.method!=="dispatch")return;const c=l.value?.params?.[0],r=c.tags?.map(({name:m,value:b})=>({name:window.atob(m),value:window.atob(b)}));return{...c,tags:r}});E(()=>i.messageEntry,async()=>{l.value=await fe(i.messageEntry)},{immediate:!0});const n=[{name:"Accept",icon:te,run:()=>i.messageEntry.status="accepted"},{name:"Reject",icon:ye,run:()=>i.messageEntry.status="rejected"}],d=[{name:"Pending",icon:ae,run:()=>{}}];return(c,r)=>ie((e(),a("div",Ue,[l.value?.method==="signTransaction"?(e(),a(I,{key:0},[Ke,u(q,{tx:s(o)},null,8,["tx"]),u(X,{tx:s(o)},null,8,["tx"])],64)):y("",!0),l.value?.method==="dispatch"?(e(),a(I,{key:1},[Fe,u(q,{tx:s(o)},null,8,["tx"]),u(X,{tx:s(o)},null,8,["tx"])],64)):l.value?.method==="getPublicKey"?(e(),a(I,{key:2},[qe],64)):l.value?.method==="getArweaveConfig"?(e(),a(I,{key:3},[Ge],64)):l.value?.method==="sign"?(e(),a(I,{key:4},[He],64)):l.value?.method==="decrypt"?(e(),a(I,{key:5},[Je],64)):y("",!0),u(ce,{name:"fade",mode:"out-in"},{default:g(()=>[t.messageEntry.status?(e(),k(Y,{key:1,actions:d})):(e(),k(Y,{key:0,actions:n}))]),_:1})],512)),[[ue,l.value]])}});var Xe=P(Qe,[["__scopeId","data-v-558bc70a"]]);const Ye={class:"flex-column no-scrollbar"},Ze=["disabled","onClick"],et=j(" Apply "),tt=A({props:{state:null,walletId:null},setup(t){const i=t,l={connect:"Connect automatically",signTransaction:"Sign transaction",getPublicKey:"Share public key",sign:"Sign arbitrary data",decrypt:"Decrypt data",getArweaveConfig:"Share arweave gateway configuration"},o=v=>Object.getOwnPropertyNames(Object.getPrototypeOf(v?.messageRunner||{})).filter(_=>{if(!(_==="constructor"||_==="methodMap"||!v))return!G(v,_)?.unavailable}).map(_=>({name:_,displayName:l[_]||_,disabled:G(v,_)?.userIntent})),n=f(()=>M(i.walletId)),d=f(()=>[...o(n.value)]),c=v=>m.value&&(m.value[v]=!m.value[v]),r=pe("connectionSettings:",i.state.origin,{}),m=$(void 0),b=$(void 0);E(n,v=>{!v?.uuid||(r.state.value||={},b.value=r.state.value[v.uuid]||={},m.value={...b.value})},{immediate:!0});const S=([v,_])=>{const p=b.value?.[v]||!1;if(_!==p)return!0},N=f(()=>m.value?Object.entries(m.value).find(S):!1),L=()=>{if(!m.value||!b.value)return!1;Object.entries(m.value).filter(S).forEach(([v,_])=>b.value&&(b.value[v]=_))};return(v,_)=>(e(),a("div",Ye,[(e(!0),a(I,null,B(s(d),p=>(e(),a("button",{key:p.name,disabled:p.disabled,class:"row method",onClick:z=>c(p.name)},[h("div",null,T(p.displayName),1),u(W,{vector:m.value[p.name]?1:-1,axis:"y"},{default:g(()=>[(e(),a("div",{key:m.value[p.name]},T(m.value[p.name]?"Allow":"Ask"),1))]),_:2},1032,["vector"])],8,Ze))),128)),u(W,null,{default:g(()=>[s(N)?(e(),k(xe,{key:0,onClick:_[0]||(_[0]=p=>L())},{default:g(()=>[et]),_:1})):y("",!0)]),_:1})]))}});var at=P(tt,[["__scopeId","data-v-41a1ea1c"]]);const nt={class:"flex-row"},st=["disabled"],lt={style:{"min-width":"0"}},ot={class:"ellipsis"},it={class:"secondary-text ellipsis"},ut={class:"page-container",key:"0"},ct={key:0},rt={class:"status fade-list-item",key:"1"},dt={key:1},vt=A({props:{state:null},setup(t){const i=t,l=ve(),o=V.value[0]?.id;f(()=>V.value.map(x=>x.key));const n=$(i.state.walletId||o),d=f(()=>M(n.value));f(()=>M(o));const c=[{name:"Requests",color:"var(--orange)"},{name:"Permissions",color:"var(--green)"}],r=$(n.value?c[0].name:null);E(()=>i.state.walletId,x=>{!x||(S.value=!1,n.value=x,r.value=c[0].name)});const m=()=>i.state.walletId=!1,b=()=>{S.value=!1,i.state.walletId=n.value+""},S=$(!i.state.walletId),N=f(()=>S.value&&V.value.length>1),L=$(0),v=()=>{if(!S.value){S.value=!0;return}n.value!==(i.state.walletId||V.value[0]?.id)&&L.value++,n.value=i.state.walletId||V.value[0]?.id,S.value=!1},_=f(()=>({actions:[{name:i.state.walletId?"Switch":"Connect",icon:te,run:b}]})),p=f(()=>n.value!==i.state.walletId?[]:i.state.messageQueue?.filter(x=>!x.fulfilled));_e(ee.breakpoints,"verticalLayout");const z=$(null),K=(x,w)=>z.value=x-w;return E(()=>c.findIndex(x=>x.name===r.value),K),E(()=>V.value.findIndex(x=>x.id===n.value),K),(x,w)=>(e(),k(se,{class:"connection-card flex-column no-scrollbar"},{header:g(()=>[h("div",nt,[h("button",{type:"button",class:"info flex-row",onClick:w[0]||(w[0]=(...C)=>s(H)&&s(H)(...C)),disabled:!s(J)(t.state.origin,t.state.session)},[u(Be,{img:t.state.appInfo?.logo,icon:s(ae)},null,8,["img","icon"]),h("div",lt,[h("div",ot,T(t.state.appInfo?.name||"Connector"),1),h("div",it,T(t.state.origin),1)]),s(J)(t.state.origin,t.state.session)?(e(),k(R,{key:0,icon:s($e)},null,8,["icon"])):y("",!0)],8,st),u(he,{modelValue:t.state.walletId,"onUpdate:modelValue":w[1]||(w[1]=C=>t.state.walletId=C),active:!s(N),onSelectWallet:v,onExit:m},null,8,["modelValue","active"])]),u(ke,{tabs:c,modelValue:r.value,"onUpdate:modelValue":w[2]||(w[2]=C=>r.value=C),disabled:!n.value},null,8,["modelValue","disabled"])]),default:g(()=>[u(W,{vector:z.value,axis:"x"},{default:g(()=>[s(V).length?(e(),a("div",{class:"container-scroll",key:L.value},[u(D,{name:"fade-list"},{default:g(()=>[s(N)?(e(),k(Te,{modelValue:n.value,"onUpdate:modelValue":w[3]||(w[3]=C=>n.value=C),class:"fade-list-item",key:"-1"},null,8,["modelValue"])):y("",!0),h("div",ut,[u(W,{vector:z.value,axis:"x"},{default:g(()=>[(e(),a("div",{key:(n.value||"")+r.value,class:"content"},[r.value==="Requests"?(e(),a("div",ct,[u(D,{name:"fade-list"},{default:g(()=>[h("div",{class:"fade-list-item",key:"0",style:F({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),s(p)?.length===0&&t.state.walletId&&t.state.walletId===n.value?(e(),a("div",rt,"Connected")):y("",!0),n.value!==t.state.walletId?(e(),k(U,{options:s(_),inline:!0,class:"fade-list-item",key:"2"},{default:g(()=>[s(d)?(e(),k(Ce,{key:0,wallet:s(d)},null,8,["wallet"])):y("",!0)]),_:1},8,["options"])):y("",!0),(e(!0),a(I,null,B(s(p),C=>(e(),k(Xe,{key:C.uuid,messageEntry:C,style:{padding:"var(--spacing)"},class:"flex-column fade-list-item"},null,8,["messageEntry"]))),128))]),_:1})])):r.value==="Permissions"?(e(),a("div",dt,[u(D,{name:"fade-list"},{default:g(()=>[h("div",{class:"fade-list-item",key:"0",style:F({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),u(at,{state:t.state,walletId:n.value,class:"fade-list-item",key:"2"},null,8,["state","walletId"])]),_:1})])):y("",!0)]))]),_:1},8,["vector"])])]),_:1})])):(e(),k(U,{key:0,options:{action:{icon:s(Ie),name:"Add wallet",run:()=>s(l).push("/add")}}},null,8,["options"]))]),_:1},8,["vector"])]),_:1}))}});var _t=P(vt,[["__scopeId","data-v-d7a3ed62"]]);const mt={class:"connect flex-column"},gt={key:0,class:"connection-card-container fade-list-item",style:{position:"relative"}},ft=A({setup(t){const i=f(()=>({action:{icon:we,name:"Connect to "+o.value,run:()=>Q("connect")}})),l=$(O.value.findIndex(n=>n.origin===be.value.origin)),o=$();return Q("state").then(n=>{!n||(o.value=n.origin,E(()=>O.value,()=>{const d=O.value.findIndex(c=>c.origin===o.value);if(d<0&&l.value>=0)return l.value=d;if(l.value<0)return setTimeout(()=>l.value=d)},{immediate:!0}))}),(n,d)=>(e(),a("div",mt,[u(Z,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=c=>l.value=c),options:{align:"start",overscroll:!0},class:"connectors"},{default:g(()=>[!s(O).length&&o.value?(e(),a("div",gt,[u(U,{options:s(i)},null,8,["options"])])):y("",!0),(e(!0),a(I,null,B(s(O),c=>(e(),a("div",{key:c.origin+c.session,class:"connection-card-container fade-list-item"},[u(_t,{state:c,class:"box"},null,8,["state"])]))),128))]),_:1},8,["modelValue"])]))}});var bt=P(ft,[["__scopeId","data-v-3e46ecbe"]]);export{bt as default};
//# sourceMappingURL=Connect.0dab55b5.js.map
