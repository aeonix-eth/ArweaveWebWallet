import{C as Z,L as se}from"./ListContainer.0e881124.js";import{_ as T,d as A,c as p,a2 as V,o as e,g as t,q as r,w as f,a0 as w,$ as B,n as le,u as s,X as oe,a3 as ie,a as b,a4 as U,I as ee,x as _,t as E,Q as de,r as $,k as P,a5 as ce,y as re,z as ue,T as q,a6 as F,a1 as ve,U as me,V as ge,b as x,h as O,a7 as ae,a8 as fe,a9 as te,aa as W,ab as G,ac as pe,v as M,B as _e,ad as ye,G as he,ae as Q,af as X,ag as be,ah as xe,ai as we,O as D,aj as ke,ak as R,M as Y,al as H,am as j,an as Ie,ao as Ce}from"./index.130e72df.js";import{P as $e}from"./ProfilePreview.7e5ce014.js";const Se={class:"wallet-tabs"},Ve=["onClick"],Pe=A({props:["modelValue"],emits:["update:modelValue"],setup(a,{emit:i}){const d=a,o=p({get(){return d.modelValue},set(u){i("update:modelValue",u)}}),n=p(()=>V.value.findIndex(u=>u.id===o.value));return(u,c)=>(e(),t("div",Se,[r(Z,{modelValue:s(n),"onUpdate:modelValue":c[0]||(c[0]=l=>ie(n)?n.value=l:null),options:{align:"center",overscroll:!0,immediate:!0}},{default:f(()=>[(e(!0),t(w,null,B(s(V),l=>(e(),t("button",{key:l.id,type:"button",onClick:g=>o.value=l.id,class:le(["tab",{active:l.id==s(o)}])},[r(oe,{address:l.key},null,8,["address"])],10,Ve))),128))]),_:1},8,["modelValue"])]))}});var Te=T(Pe,[["__scopeId","data-v-35e1b97b"]]);const je={class:"icon-background"},Ee={props:["icon","img"],setup(a){return(i,d)=>(e(),t("div",je,[a.img?(e(),b(U,{key:0,class:"page-logo",icon:a.img},null,8,["icon"])):(e(),b(U,{key:1,class:"page-logo placeholder",icon:a.icon},null,8,["icon"]))]))}};var Ae=T(Ee,[["__scopeId","data-v-7f69d89a"]]);const Be={class:"tx-card-extension"},Oe={key:0,class:"flex-row",style:{"justify-content":"space-between"}},Ne={key:0},ze={key:1},Le={key:1,class:"tags secondary-text no-scrollbar"},Me={props:["tx"],setup(a){return p(()=>ee.breakpoints.verticalLayout),(i,d)=>(e(),t("div",Be,[a.tx.tags.length||a.tx.data_size?(e(),t("div",Oe,[a.tx.tags.length?(e(),t("div",Ne,"Tags:")):_("",!0),a.tx.data_size?(e(),t("div",ze,"Data: "+E(s(de)(a.tx.data_size)),1)):_("",!0)])):_("",!0),a.tx.tags.length?(e(),t("ul",Le,[(e(!0),t(w,null,B(a.tx.tags,o=>(e(),t("li",null,E(o.name+" | "+o.value),1))),256))])):_("",!0)]))}};var J=T(Me,[["__scopeId","data-v-5ee7fb30"]]);const ne=a=>(me("data-v-558bc70a"),a=a(),ge(),a),Re={class:"permission-card"},Ue=ne(()=>x("span",null,"Sign transaction",-1)),We=ne(()=>x("span",null,"Sign transaction and upload",-1)),De=O(" Share the public key "),Ke=O(" Share the arweave config "),qe=O(" Sign data "),Fe=O(" Decrypt data "),Ge=A({props:{messageEntry:null},setup(a){const i=a,d=$(null),o=p(()=>{if(d.value?.method!=="signTransaction"&&d.value?.method!=="dispatch")return;const c=d.value?.params?.[0],l=c.tags?.map(({name:g,value:k})=>({name:window.atob(g),value:window.atob(k)}));return{...c,tags:l}});P(()=>i.messageEntry,async()=>{d.value=await ce(i.messageEntry)},{immediate:!0});const n=[{name:"Accept",icon:ae,run:()=>i.messageEntry.status="accepted"},{name:"Reject",icon:fe,run:()=>i.messageEntry.status="rejected"}],u=[{name:"Pending",icon:te,run:()=>{}}];return(c,l)=>re((e(),t("div",Re,[d.value?.method==="signTransaction"?(e(),t(w,{key:0},[Ue,r(q,{tx:s(o)},null,8,["tx"]),r(J,{tx:s(o)},null,8,["tx"])],64)):_("",!0),d.value?.method==="dispatch"?(e(),t(w,{key:1},[We,r(q,{tx:s(o)},null,8,["tx"]),r(J,{tx:s(o)},null,8,["tx"])],64)):d.value?.method==="getPublicKey"?(e(),t(w,{key:2},[De],64)):d.value?.method==="getArweaveConfig"?(e(),t(w,{key:3},[Ke],64)):d.value?.method==="sign"?(e(),t(w,{key:4},[qe],64)):d.value?.method==="decrypt"?(e(),t(w,{key:5},[Fe],64)):_("",!0),r(ve,{name:"fade",mode:"out-in"},{default:f(()=>[a.messageEntry.status?(e(),b(F,{key:1,actions:u})):(e(),b(F,{key:0,actions:n}))]),_:1})],512)),[[ue,d.value]])}});var Qe=T(Ge,[["__scopeId","data-v-558bc70a"]]);const Xe={class:"flex-column no-scrollbar"},Ye=["disabled","onClick"],He=O(" Apply "),Je=A({props:{state:null,walletId:null},setup(a){const i=a,d={connect:"Connect automatically",signTransaction:"Sign transaction",getPublicKey:"Share public key",sign:"Sign arbitrary data",decrypt:"Decrypt data",getArweaveConfig:"Share arweave gateway configuration"},o=v=>["connect"].concat(Object.getOwnPropertyNames(Object.getPrototypeOf(v?.messageRunner||{}))).filter(m=>{if(!(m==="constructor"||m==="methodMap"||!v))return!G(v,m)?.unavailable}).map(m=>({name:m,displayName:d[m]||m,disabled:G(v,m)?.userIntent})),n=p(()=>W(i.walletId)),u=p(()=>[...o(n.value)]),c=v=>g.value&&(g.value[v]=!g.value[v]),l=pe("connectionSettings:",i.state.origin,{}),g=$(void 0),k=$(void 0);P(n,v=>{!v?.uuid||(l.state.value||={},k.value=l.state.value[v.uuid]||={},g.value={...k.value})},{immediate:!0});const S=([v,m])=>{const y=k.value?.[v]||!1;if(m!==y)return!0},N=p(()=>g.value?Object.entries(g.value).find(S):!1),z=()=>{if(!g.value||!k.value)return!1;Object.entries(g.value).filter(S).forEach(([v,m])=>k.value&&(k.value[v]=m))};return(v,m)=>(e(),t("div",Xe,[(e(!0),t(w,null,B(s(u),y=>(e(),t("button",{key:y.name,disabled:y.disabled,class:"row method",onClick:L=>c(y.name)},[x("div",null,E(y.displayName),1),r(M,{vector:g.value[y.name]?1:-1,axis:"y"},{default:f(()=>[(e(),t("div",{key:g.value[y.name]},E(g.value[y.name]?"Allow":"Ask"),1))]),_:2},1032,["vector"])],8,Ye))),128)),r(M,null,{default:f(()=>[s(N)?(e(),b(_e,{key:0,onClick:m[0]||(m[0]=y=>z())},{default:f(()=>[He]),_:1})):_("",!0)]),_:1})]))}});var Ze=T(Je,[["__scopeId","data-v-239033a2"]]);const ea={class:"flex-row"},aa=["disabled"],ta={style:{"min-width":"0"}},na={class:"ellipsis"},sa={class:"secondary-text ellipsis"},la={class:"page-container",key:"0"},oa={key:0},ia={class:"status fade-list-item",key:"1"},da={key:1},ca=A({props:{state:null},setup(a){const i=a,d=ye(),o=V.value[0]?.id;p(()=>V.value.map(h=>h.key));const n=$(i.state.walletId||o),u=p(()=>W(n.value));p(()=>W(o));const c=[{name:"Requests",color:"var(--orange)"},{name:"Permissions",color:"var(--green)"}],l=$(n.value?c[0].name:null);P(()=>i.state.walletId,h=>{!h||(S.value=!1,n.value=h,l.value=c[0].name)});const g=()=>i.state.walletId=!1,k=()=>{S.value=!1,i.state.walletId=n.value+""},S=$(!i.state.walletId),N=p(()=>S.value&&V.value.length>1),z=$(0),v=()=>{if(!S.value){S.value=!0;return}n.value!==(i.state.walletId||V.value[0]?.id)&&z.value++,n.value=i.state.walletId||V.value[0]?.id,S.value=!1},m=p(()=>({actions:[{name:i.state.walletId?"Switch":"Connect",icon:ae,run:k}]})),y=p(()=>n.value!==i.state.walletId?[]:i.state.messageQueue?.filter(h=>!h.fulfilled));he(ee.breakpoints,"verticalLayout");const L=$(null),K=(h,I)=>L.value=h-I;return P(()=>c.findIndex(h=>h.name===l.value),K),P(()=>V.value.findIndex(h=>h.id===n.value),K),(h,I)=>(e(),b(se,{class:"connection-card flex-column no-scrollbar"},{header:f(()=>[x("div",ea,[x("button",{type:"button",class:"info flex-row",onClick:I[0]||(I[0]=(...C)=>s(Q)&&s(Q)(...C)),disabled:!s(X)(a.state.origin,a.state.session)},[r(Ae,{img:a.state.appInfo?.logo,icon:s(te)},null,8,["img","icon"]),x("div",ta,[x("div",na,E(a.state.appInfo?.name||"Connector"),1),x("div",sa,E(a.state.origin),1)]),s(X)(a.state.origin,a.state.session)?(e(),b(U,{key:0,icon:s(be)},null,8,["icon"])):_("",!0)],8,aa),r(xe,{modelValue:a.state.walletId,"onUpdate:modelValue":I[1]||(I[1]=C=>a.state.walletId=C),active:!s(N),onSelectWallet:v,onExit:g},null,8,["modelValue","active"])]),r(we,{tabs:c,modelValue:l.value,"onUpdate:modelValue":I[2]||(I[2]=C=>l.value=C),disabled:!n.value},null,8,["modelValue","disabled"])]),default:f(()=>[r(M,{vector:L.value,axis:"x"},{default:f(()=>[s(V).length?(e(),t("div",{class:"container-scroll",key:z.value},[r(R,{name:"fade-list"},{default:f(()=>[s(N)?(e(),b(Te,{modelValue:n.value,"onUpdate:modelValue":I[3]||(I[3]=C=>n.value=C),class:"fade-list-item",key:"-1"},null,8,["modelValue"])):_("",!0),x("div",la,[r(M,{vector:L.value,axis:"x"},{default:f(()=>[(e(),t("div",{key:(n.value||"")+l.value,class:"content"},[l.value==="Requests"?(e(),t("div",oa,[r(R,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:Y({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),s(y)?.length===0&&a.state.walletId&&a.state.walletId===n.value?(e(),t("div",ia,"Connected")):_("",!0),n.value!==a.state.walletId?(e(),b(D,{options:s(m),inline:!0,class:"fade-list-item",key:"2"},{default:f(()=>[s(u)?(e(),b($e,{key:0,wallet:s(u)},null,8,["wallet"])):_("",!0)]),_:1},8,["options"])):_("",!0),(e(!0),t(w,null,B(s(y),C=>(e(),b(Qe,{key:C.uuid,messageEntry:C,style:{padding:"var(--spacing)"},class:"flex-column fade-list-item"},null,8,["messageEntry"]))),128))]),_:1})])):l.value==="Permissions"?(e(),t("div",da,[r(R,{name:"fade-list"},{default:f(()=>[x("div",{class:"fade-list-item",key:"0",style:Y({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),r(Ze,{state:a.state,walletId:n.value,class:"fade-list-item",key:"2"},null,8,["state","walletId"])]),_:1})])):_("",!0)]))]),_:1},8,["vector"])])]),_:1})])):(e(),b(D,{key:0,options:{action:{icon:s(ke),name:"Add wallet",run:()=>s(d).push("/add")}}},null,8,["options"]))]),_:1},8,["vector"])]),_:1}))}});var ra=T(ca,[["__scopeId","data-v-d7a3ed62"]]);const ua={class:"connect flex-column"},va={key:0,class:"connection-card-container fade-list-item",style:{position:"relative"}},ma=A({setup(a){const i=p(()=>({action:{icon:Ie,name:"Connect to "+n.value,run:()=>H("connect")}}));let d=!0;setTimeout(()=>d=!1,500);const o=$(-1);P(j,()=>{const u=j.value.findIndex(c=>c.origin===Ce.value.origin);!d||u<0||o.value>=0||(o.value=u,d=!1)},{immediate:!0});const n=$();return H("state").then(u=>{!u||(n.value=u.origin,P(()=>j.value,()=>{const c=j.value.findIndex(l=>l.origin===n.value);if(c<0&&o.value>=0)return o.value=c;if(o.value<0)return setTimeout(()=>o.value=c)},{immediate:!0}))}),(u,c)=>(e(),t("div",ua,[r(Z,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=l=>o.value=l),options:{align:"start",overscroll:!0},class:"connectors"},{default:f(()=>[!s(j).length&&n.value?(e(),t("div",va,[r(D,{options:s(i)},null,8,["options"])])):_("",!0),(e(!0),t(w,null,B(s(j),l=>(e(),t("div",{key:l.origin+l.session,class:"connection-card-container fade-list-item"},[r(ra,{state:l,class:"box"},null,8,["state"])]))),128))]),_:1},8,["modelValue"])]))}});var _a=T(ma,[["__scopeId","data-v-51c8a3de"]]);export{_a as default};
//# sourceMappingURL=Connect.7aeed9f7.js.map
