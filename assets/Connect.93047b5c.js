import{C as Z,L as ce}from"./ListContainer.3a48d48e.js";import{h as B,d as y,j as e,k as a,N as c,I as p,u as s,O as ee,R as f,a3 as te,a4 as ae,l as g,F as b,n as A,i as re,H as k,Q as T,r as C,w as E,V as de,W as ve,K as _e,P as W,aj as me,M as ge,a5 as D,p as F}from"./vendor.e01a535e.js";import{_ as P,o as M,m as ne,e as N,p as V,q as R,I as se,i as ye,r as fe,T as q,s as le,t as pe,v as oe,w as H,x as xe,B as he,y as G,z as Q,C as ke,O as K,D as be,E as O,G as Ie,H as J,J as we}from"./index.17a2e966.js";import{P as $e}from"./ProfilePreview.a51be11f.js";import{I as Ce}from"./launch.63fac78a.js";const ie=t=>(te("data-v-4a1a07c6"),t=t(),ae(),t),Se={class:"wallet-selector"},Ve=ie(()=>g("div",{class:"exit-background"},null,-1)),Pe=ie(()=>g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[g("path",{d:"M0 0h24v24H0V0z",fill:"none"}),g("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})],-1)),Te=[Ve,Pe],Be=B({props:{modelValue:String,exit:Boolean,active:Boolean},emits:["update:modelValue","selectWallet","exit"],setup(t,{emit:i}){const l=t,o=y({get(){return l.modelValue},set(r){i("update:modelValue",r)}}),n=y(()=>M(o.value)?.key);return(r,u)=>(e(),a("div",Se,[c(N,null,{default:p(()=>[s(o)?(e(),a("button",{key:0,type:"button",onClick:u[0]||(u[0]=d=>r.$emit("selectWallet")),class:ee(["tab",{active:t.active}])},[c(ne,{address:s(n)},null,8,["address"])],2)):f("",!0)]),_:1}),t.exit?(e(),a("button",{key:0,class:"exit",type:"button",onClick:u[1]||(u[1]=d=>r.$emit("exit"))},Te)):f("",!0)]))}});var Ee=P(Be,[["__scopeId","data-v-4a1a07c6"]]);const Ae={class:"wallet-tabs"},Oe=["onClick"],Ne=B({props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:i}){const l=t,o=y({get(){return l.modelValue},set(r){i("update:modelValue",r)}}),n=y(()=>V.value.findIndex(r=>r.id===o.value));return(r,u)=>(e(),a("div",Ae,[c(Z,{modelValue:s(n),"onUpdate:modelValue":u[0]||(u[0]=d=>re(n)?n.value=d:null),options:{align:"center",overscroll:!0,immediate:!0}},{default:p(()=>[(e(!0),a(b,null,A(s(V),d=>(e(),a("button",{key:d.id,type:"button",onClick:m=>o.value=d.id,class:ee(["tab",{active:d.id==s(o)}])},[c(ne,{address:d.key},null,8,["address"])],10,Oe))),128))]),_:1},8,["modelValue"])]))}});var We=P(Ne,[["__scopeId","data-v-35e1b97b"]]);const je={class:"icon-background"},ze={props:["icon","img"],setup(t){return(i,l)=>(e(),a("div",je,[t.img?(e(),k(R,{key:0,class:"page-logo",icon:t.img},null,8,["icon"])):(e(),k(R,{key:1,class:"page-logo placeholder",icon:t.icon},null,8,["icon"]))]))}};var Le=P(ze,[["__scopeId","data-v-7f69d89a"]]);const Me={class:"tx-card-extension"},Re={key:0,class:"flex-row",style:{"justify-content":"space-between"}},De={key:0},Ke={key:1},Ue={key:1,class:"tags secondary-text no-scrollbar"},Fe={props:["tx"],setup(t){return y(()=>se.breakpoints.verticalLayout),(i,l)=>(e(),a("div",Me,[t.tx.tags.length||t.tx.data_size?(e(),a("div",Re,[t.tx.tags.length?(e(),a("div",De,"Tags:")):f("",!0),t.tx.data_size?(e(),a("div",Ke,"Data: "+T(s(ye)(t.tx.data_size)),1)):f("",!0)])):f("",!0),t.tx.tags.length?(e(),a("ul",Ue,[(e(!0),a(b,null,A(t.tx.tags,o=>(e(),a("li",null,T(o.name+" | "+o.value),1))),256))])):f("",!0)]))}};var X=P(Fe,[["__scopeId","data-v-5ee7fb30"]]);const qe={class:"actions-list flex-row"},He=["onClick"],Ge=B({props:{actions:null},setup(t){return(i,l)=>(e(),a("div",qe,[(e(!0),a(b,null,A(t.actions,o=>(e(),a("button",{key:o.name,onClick:o.run,type:"button",class:"action flex-row"},[c(R,{icon:o.icon},null,8,["icon"]),g("div",null,T(o.name),1)],8,He))),128))]))}});var Y=P(Ge,[["__scopeId","data-v-7477f216"]]);const ue=t=>(te("data-v-558bc70a"),t=t(),ae(),t),Qe={class:"permission-card"},Je=ue(()=>g("span",null,"Sign transaction",-1)),Xe=ue(()=>g("span",null,"Sign transaction and upload",-1)),Ye=W(" Share the public key "),Ze=W(" Share the arweave config "),et=W(" Sign data "),tt=W(" Decrypt data "),at=B({props:{messageEntry:null},setup(t){const i=t,l=C(null),o=y(()=>{if(l.value?.method!=="signTransaction"&&l.value?.method!=="dispatch")return;const u=l.value?.params?.[0],d=u.tags?.map(({name:m,value:I})=>({name:window.atob(m),value:window.atob(I)}));return{...u,tags:d}});E(()=>i.messageEntry,async()=>{l.value=await fe(i.messageEntry)},{immediate:!0});const n=[{name:"Accept",icon:le,run:()=>i.messageEntry.status="accepted"},{name:"Reject",icon:pe,run:()=>i.messageEntry.status="rejected"}],r=[{name:"Pending",icon:oe,run:()=>{}}];return(u,d)=>de((e(),a("div",Qe,[l.value?.method==="signTransaction"?(e(),a(b,{key:0},[Je,c(q,{tx:s(o)},null,8,["tx"]),c(X,{tx:s(o)},null,8,["tx"])],64)):f("",!0),l.value?.method==="dispatch"?(e(),a(b,{key:1},[Xe,c(q,{tx:s(o)},null,8,["tx"]),c(X,{tx:s(o)},null,8,["tx"])],64)):l.value?.method==="getPublicKey"?(e(),a(b,{key:2},[Ye],64)):l.value?.method==="getArweaveConfig"?(e(),a(b,{key:3},[Ze],64)):l.value?.method==="sign"?(e(),a(b,{key:4},[et],64)):l.value?.method==="decrypt"?(e(),a(b,{key:5},[tt],64)):f("",!0),c(_e,{name:"fade",mode:"out-in"},{default:p(()=>[t.messageEntry.status?(e(),k(Y,{key:1,actions:r})):(e(),k(Y,{key:0,actions:n}))]),_:1})],512)),[[ve,l.value]])}});var nt=P(at,[["__scopeId","data-v-558bc70a"]]);const st={class:"flex-column no-scrollbar"},lt=["disabled","onClick"],ot=W(" Apply "),it=B({props:{state:null,walletId:null},setup(t){const i=t,l={connect:"Connect automatically",signTransaction:"Sign transaction",getPublicKey:"Share public key",sign:"Sign arbitrary data",decrypt:"Decrypt data",getArweaveConfig:"Share arweave gateway configuration"},o=v=>Object.getOwnPropertyNames(Object.getPrototypeOf(v?.messageRunner||{})).filter(_=>{if(!(_==="constructor"||_==="methodMap"||!v))return!H(v,_)?.unavailable}).map(_=>({name:_,displayName:l[_]||_,disabled:H(v,_)?.userIntent})),n=y(()=>M(i.walletId)),r=y(()=>[...o(n.value)]),u=v=>m.value&&(m.value[v]=!m.value[v]),d=xe("connectionSettings:",i.state.origin,{}),m=C(void 0),I=C(void 0);E(n,v=>{!v?.uuid||(d.state.value||={},I.value=d.state.value[v.uuid]||={},m.value={...I.value})},{immediate:!0});const S=([v,_])=>{const x=I.value?.[v]||!1;if(_!==x)return!0},j=y(()=>m.value?Object.entries(m.value).find(S):!1),z=()=>{if(!m.value||!I.value)return!1;Object.entries(m.value).filter(S).forEach(([v,_])=>I.value&&(I.value[v]=_))};return(v,_)=>(e(),a("div",st,[(e(!0),a(b,null,A(s(r),x=>(e(),a("button",{key:x.name,disabled:x.disabled,class:"row method",onClick:L=>u(x.name)},[g("div",null,T(x.displayName),1),c(N,{vector:m.value[x.name]?1:-1,axis:"y"},{default:p(()=>[(e(),a("div",{key:m.value[x.name]},T(m.value[x.name]?"Allow":"Ask"),1))]),_:2},1032,["vector"])],8,lt))),128)),c(N,null,{default:p(()=>[s(j)?(e(),k(he,{key:0,onClick:_[0]||(_[0]=x=>z())},{default:p(()=>[ot]),_:1})):f("",!0)]),_:1})]))}});var ut=P(it,[["__scopeId","data-v-41a1ea1c"]]);const ct={class:"flex-row"},rt=["disabled"],dt={style:{"min-width":"0"}},vt={class:"ellipsis"},_t={class:"secondary-text ellipsis"},mt={class:"page-container",key:"0"},gt={key:0},yt={class:"status fade-list-item",key:"1"},ft={key:1},pt=B({props:{state:null},setup(t){const i=t,l=me(),o=V.value[0]?.id;y(()=>V.value.map(h=>h.key));const n=C(i.state.walletId||o),r=y(()=>M(n.value));y(()=>M(o));const u=[{name:"Requests",color:"var(--orange)"},{name:"Permissions",color:"var(--green)"}],d=C(n.value?u[0].name:null);E(()=>i.state.walletId,h=>{!h||(S.value=!1,n.value=h,d.value=u[0].name)});const m=()=>i.state.walletId=!1,I=()=>{S.value=!1,i.state.walletId=n.value+""},S=C(!i.state.walletId),j=y(()=>S.value&&V.value.length>1),z=C(0),v=()=>{if(!S.value){S.value=!0;return}n.value!==(i.state.walletId||V.value[0]?.id)&&z.value++,n.value=i.state.walletId||V.value[0]?.id,S.value=!1},_=y(()=>({actions:[{name:i.state.walletId?"Switch":"Connect",icon:le,run:I}]})),x=y(()=>n.value!==i.state.walletId?[]:i.state.messageQueue?.filter(h=>!h.fulfilled));ge(se.breakpoints,"verticalLayout");const L=C(null),U=(h,w)=>L.value=h-w;return E(()=>u.findIndex(h=>h.name===d.value),U),E(()=>V.value.findIndex(h=>h.id===n.value),U),(h,w)=>(e(),k(ce,{class:"connection-card flex-column no-scrollbar"},{header:p(()=>[g("div",ct,[g("button",{type:"button",class:"info flex-row",onClick:w[0]||(w[0]=(...$)=>s(G)&&s(G)(...$)),disabled:!s(Q)(t.state.origin,t.state.session)},[c(Le,{img:t.state.appInfo?.logo,icon:s(oe)},null,8,["img","icon"]),g("div",dt,[g("div",vt,T(t.state.appInfo?.name||"Connector"),1),g("div",_t,T(t.state.origin),1)]),s(Q)(t.state.origin,t.state.session)?(e(),k(R,{key:0,icon:s(Ce)},null,8,["icon"])):f("",!0)],8,rt),c(Ee,{modelValue:t.state.walletId,"onUpdate:modelValue":w[1]||(w[1]=$=>t.state.walletId=$),exit:!0,active:!s(j),onSelectWallet:v,onExit:m},null,8,["modelValue","active"])]),c(ke,{tabs:u,modelValue:d.value,"onUpdate:modelValue":w[2]||(w[2]=$=>d.value=$),disabled:!n.value},null,8,["modelValue","disabled"])]),default:p(()=>[c(N,{vector:L.value,axis:"x"},{default:p(()=>[s(V).length?(e(),a("div",{class:"container-scroll",key:z.value},[c(D,{name:"fade-list"},{default:p(()=>[s(j)?(e(),k(We,{modelValue:n.value,"onUpdate:modelValue":w[3]||(w[3]=$=>n.value=$),class:"fade-list-item",key:"-1"},null,8,["modelValue"])):f("",!0),g("div",mt,[c(N,{vector:L.value,axis:"x"},{default:p(()=>[(e(),a("div",{key:(n.value||"")+d.value,class:"content"},[d.value==="Requests"?(e(),a("div",gt,[c(D,{name:"fade-list"},{default:p(()=>[g("div",{class:"fade-list-item",key:"0",style:F({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),s(x)?.length===0&&t.state.walletId&&t.state.walletId===n.value?(e(),a("div",yt,"Connected")):f("",!0),n.value!==t.state.walletId?(e(),k(K,{options:s(_),inline:!0,class:"fade-list-item",key:"2"},{default:p(()=>[s(r)?(e(),k($e,{key:0,wallet:s(r)},null,8,["wallet"])):f("",!0)]),_:1},8,["options"])):f("",!0),(e(!0),a(b,null,A(s(x),$=>(e(),k(nt,{key:$.uuid,messageEntry:$,style:{padding:"var(--spacing)"},class:"flex-column fade-list-item"},null,8,["messageEntry"]))),128))]),_:1})])):d.value==="Permissions"?(e(),a("div",ft,[c(D,{name:"fade-list"},{default:p(()=>[g("div",{class:"fade-list-item",key:"0",style:F({padding:0,border:0,outline:"0.5px solid var(--border)"})},null,4),c(ut,{state:t.state,walletId:n.value,class:"fade-list-item",key:"2"},null,8,["state","walletId"])]),_:1})])):f("",!0)]))]),_:1},8,["vector"])])]),_:1})])):(e(),k(K,{key:0,options:{action:{icon:s(be),name:"Add wallet",run:()=>s(l).push("/add")}}},null,8,["options"]))]),_:1},8,["vector"])]),_:1}))}});var xt=P(pt,[["__scopeId","data-v-4700489c"]]);const ht={class:"connect flex-column"},kt={key:0,class:"connection-card-container fade-list-item",style:{position:"relative"}},bt=B({setup(t){const i=y(()=>({action:{icon:we,name:"Connect to "+o.value,run:()=>J("connect")}})),l=C(O.value.findIndex(n=>n.origin===Ie.value.origin)),o=C();return J("state").then(n=>{!n||(o.value=n.origin,E(()=>O.value,()=>{const r=O.value.findIndex(u=>u.origin===o.value);if(r<0&&l.value>=0)return l.value=r;if(l.value<0)return setTimeout(()=>l.value=r)},{immediate:!0}))}),(n,r)=>(e(),a("div",ht,[c(Z,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=u=>l.value=u),options:{align:"start",overscroll:!0},class:"connectors"},{default:p(()=>[!s(O).length&&o.value?(e(),a("div",kt,[c(K,{options:s(i)},null,8,["options"])])):f("",!0),(e(!0),a(b,null,A(s(O),u=>(e(),a("div",{key:u.origin+u.session,class:"connection-card-container fade-list-item"},[c(xt,{state:u,class:"box"},null,8,["state"])]))),128))]),_:1},8,["modelValue"])]))}});var Vt=P(bt,[["__scopeId","data-v-3e46ecbe"]]);export{Vt as default};
//# sourceMappingURL=Connect.93047b5c.js.map
